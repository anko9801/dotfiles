#!/usr/bin/env bash
# Git pre-commit hook - prevent committing secrets

set -euo pipefail

# Check if gitleaks is installed
if ! command -v gitleaks &>/dev/null; then
    echo "Warning: gitleaks not found. Install it to scan for secrets."
    echo "  brew install gitleaks  # macOS"
    echo "  or see: https://github.com/gitleaks/gitleaks#installation"
    exit 0
fi

# Run gitleaks on staged changes
gitleaks protect --staged --redact \
    --config "${GITLEAKS_CONFIG:-$HOME/.config/gitleaks/config.toml}" \
    --exit-code 1